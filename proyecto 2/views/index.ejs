<%- include('template/head', { titleWeb: 'Libros', cssStyle: 'css/style.css' }) %>

  <%- include('template/navbar') %>

    <!-- Contenido principal -->
    <main class="content">

      <div class="container-fluid">

        <!-- Título de la página -->
        <div class="mb-4">
          <h2>Gestión de Libros</h2>
          <p class="text-muted">Consulta, agrega, edita o elimina libros de tu colección fácilmente.</p>
        </div>

        <!-- Mensajes Flash -->
        <% if (messages.success) { %>
          <div class="alert alert-success alert-dismissible fade show" role="alert">
            <%- messages.success %>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
          </div>
          <% } %>

            <% if (messages.error) { %>
              <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <%- messages.error %>
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
              </div>
              <% } %>

                <!-- Tarjeta de libros -->
                <div class="card shadow-sm">
                  <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Lista de Libros</h5>
                    <a class="btn btn-sm btn-primary" href="/add">
                      <i class="bi bi-plus-circle"></i> Agregar
                    </a>
                  </div>
                  <div class="card-body">
                    <% if (data.length) { %>
                      <div class="table-responsive">
                        <table class="table table-striped table-hover align-middle text-center">
                          <thead class="table-dark">
                            <tr>
                              <th>#</th>
                              <th>Título</th>
                              <th>Autor</th>
                              <th>Categoría</th>
                              <th>Editorial</th>
                              <th>Año</th>
                              <th>Páginas</th>
                              <th style="width: 200px;">Acciones</th>
                            </tr>
                          </thead>
                          <tbody>
                            <% data.forEach((book, i)=> { %>
                              <tr>
                                <th scope="row">
                                  <%= i + 1 %>
                                </th>
                                <td>
                                  <%= book.name %>
                                </td>
                                <td>
                                  <%= book.author %>
                                </td>
                                <td>
                                  <%= book.category %>
                                </td>
                                <td>
                                  <%= book.publisher %>
                                </td>
                                <td>
                                  <%= book.year_published || '-' %>
                                </td>
                                <td>
                                  <%= book.num_pages || '-' %>
                                </td>
                                <td>
                                  <a class="btn btn-sm btn-success" href="/edit/<%= book.id %>"><i
                                      class="bi bi-pencil"></i></a>
                                  <a class="btn btn-sm btn-danger" href="/delete/<%= book.id %>"
                                    onclick="return confirm('¿Estás seguro de que deseas eliminar este libro?')"><i
                                      class="bi bi-trash"></i></a>
                                </td>
                              </tr>
                              <% }) %>
                          </tbody>
                        </table>
                      </div>
                      <% } else { %>
                        <p class="text-center text-muted mb-0">No se encontraron libros.</p>
                        <% } %>
                  </div>
                </div>

      </div>
    </main>

    </div>

    <%- include('template/footer') %>